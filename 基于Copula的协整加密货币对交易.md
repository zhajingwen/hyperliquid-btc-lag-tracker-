# 基于Copula的协整加密货币对交易

**作者**: Masood Tadi<sup>1,2*</sup> 和 Jiří Witzany<sup>2</sup>

**机构**:
1. 查尔斯大学数学与物理学院概率与数理统计系,捷克布拉格
2. 布拉格经济与商业大学财务与会计学院,捷克布拉格

**出版**: Financial Innovation (2025) 11:40

---

## 摘要

本研究针对协整的加密货币对引入了一种基于copula的新型配对交易策略。为了识别最合适的交易对并从参考资产生成交易信号以分析错价指数,本研究采用了线性和非线性协整检验、相关系数度量,并拟合了不同的copula族。然后通过对各种开仓触发条件进行回测来评估策略的表现,评估其收益和风险。研究结果表明,所提出的方法在盈利能力和风险调整后收益方面优于以往基于协整或copula的配对交易策略。

**关键词**: 统计套利, 配对交易, 协整, Copulas, 加密货币市场

---

## 1. 引言

配对交易是一种著名的算法交易策略,它利用两个或多个资产之间的临时异常关系,这些资产的历史价格倾向于一起波动。当这种关系开始表现出异常行为时,就会触发开仓交易信号。当资产恢复到正常行为时,头寸就会平仓(Vidyamurthy 2004)。根据Krauss(2017)的说法,配对交易的特点是形成期和交易期。在形成期,目标是识别表现出相似价格变动的资产对。

这通常通过共同运动标准来实现,可以使用各种方法进行测量。例如:

- **距离方法**: Gatev等人(2006)、Perlin(2009)、Do和Faff(2010, 2012)使用距离度量,如归一化资产价格的最小平方距离和
- **协整方法**: 由Vidyamurthy(2004)引入,Rad等人(2016)、Clegg和Krauss(2018)、Fil和Kristoufek(2020)以及Tadi和Kortchemski(2021)使用统计关系,如协整规则

此外,在形成期估计交易期的参数。在交易时间范围内,配对价格运动的不规律性旨在从统计套利机会中获益,并创建开多仓或空仓的信号。

先进的策略可以利用各种数学工具来优化其结果的有效性。这些工具包括:

- **随机过程**: Elliott等人(2005)、Bertram(2010)和Bogomolov(2013)的研究
- **随机控制技术**: Jurek和Yang(2007)、Mudchanatongsuk等人(2008)、Tourin和Yan(2013)以及Lintilhac和Tourin(2017)的研究
- **基于copula的方法**: Liew和Yuan(2013)、Rad等人(2016)、Krauss和Stübinger(2017)以及Silva等人(2023)的研究
- **机器学习或深度学习方法**: Sarmento和Horta(2020)、Brim(2020)和Chang(2021)的研究

### 1.1 研究目标

本研究旨在通过对协整的加密货币对采用基于参考资产的copula方法来实施配对交易策略。

个人投资者和投资公司重视统计套利策略,如加密货币市场中的配对交易,这使其成为一个有效的研究领域。我们特别关注能够产生一致回报的交易策略。配对交易在去中心化的加密货币市场中可以盈利,提供两种潜在的套利机会:

1. **交易所间套利**
2. **统计套利**

Borri和Shakhnov(2022)为在加密货币交易所观察到的价格差异提供了基于风险的新解释。为了理解这些差异,他们强调了诸如交易成本、市场流动性和投资者情绪等重要因素。然而,实施交易所间套利可能存在风险并带来许多挑战。相比之下,统计套利机会提供类似的盈利潜力但风险较低(Pritchard 2018)。

加密货币市场以其波动性而闻名,这可能会降低市场效率并可能为交易者提供套利机会,正如Al-Yahyaee(2020)所强调的那样。因此,投资者被驱使探索创新的交易策略。这类算法交易策略可以提供一种更有条理和有组织的方式来导航加密货币市场,利用市场波动性来潜在地提高盈利能力。

---

## 2. 文献综述

### 2.1 配对交易方法

多项研究使用了各种概念,如距离方法、协整分析或copula概念,在配对交易策略中。

#### 2.1.1 距离方法

距离方法涉及计算两个相关资产之间的历史价格利差或价格差异,并随时间监控这种利差。例如,Gatev等人(2006)将时间t资产i和j之间的归一化利差S<sub>ij</sub><sub>t</sub>定义为:

**公式(1)**:
$$S_{t}^{ij} = P_{t}^{i*} - P_{t}^{j*}$$

其中:
$$P_{t}^{i*} = \frac{P_{t}^{i}}{P_{0}^{i}} = \prod_{\tau=1}^{t} \frac{P_{\tau}^{i}}{P_{\tau-1}^{i}} = \prod_{\tau=1}^{t} (1 + r_{\tau}^{i}) = cr_{t}^{i}$$

**公式(3)** - 平方距离和(SSD):
$$SSD_{i,j} = \sum_{t=1}^{T} (S_{t}^{ij})^{2} = \sum_{t=1}^{T} (cr_{i,t} - cr_{j,t})^{2}$$

根据形成阶段SSD<sub>i,j</sub>的升序选择交易期的配对。选择列表顶部的初始配对,并采用基本的非参数阈值规则来生成交易规则。

#### 2.1.2 协整方法

Huck(2015)发现协整方法在选择有效配对方面优于距离方法。协整方法旨在识别一起移动的非平稳时间序列(例如资产价格)之间的长期均衡。这种均衡可以是线性或非线性的。

**Engle-Granger协整检验**: Engle和Granger(1987)引入了第一个协整检验,该检验基于线性回归和均衡残差的单位根检验。通常使用增强Dickey-Fuller(ADF)检验进行单位根检验。

**非线性协整**: 高度波动的市场(如加密货币)通常表现出非线性特征。因此,我们可以通过调整误差修正模型并应用非线性单位根检验来扩展Engle-Granger协整检验,以提高研究的可靠性。Enders和Siklos(2001)、Hansen和Seo(2002)以及Kapetanios等人(2006)研究了这些扩展。

### 2.2 Copula方法

除了上述常用方法外,还可以应用更先进的概念(如copula)来增强策略的实证结果。与相关性或基于线性协整的方法相比,copula方法提供了关于配对依赖性形状和特征的更有价值的信息(Ferreira 2008)。

Xie和Wu(2013)证明,在某些条件下,常用的距离和协整方法可以被概括为copula方法的特例。这意味着copula方法中资产的依赖结构更加稳健和准确。

根据Krauss和Stübinger(2017),copula方法可以分为两个子流:

#### 2.2.1 基于收益的Copula方法

在基于收益的copula方法中,计算两个资产的对数收益并估计其边际分布。然后选择适当的copula来表示两个资产之间的依赖关系。

与使用基于利差的错价定义的距离和协整方法不同,copula方法基于相应资产对数收益的copula条件概率分布来定义错价。

**公式(4)** - Copula条件分布:
$$h^{1|2} := h(u_{1}|u_{2}) = P(U_{1} \leq u_{1}|U_{2} = u_{2}) = \frac{\partial C(u_{1}, u_{2})}{\partial u_{2}}$$

$$h^{2|1} := h(u_{2}|u_{1}) = P(U_{2} \leq u_{2}|U_{1} = u_{1}) = \frac{\partial C(u_{1}, u_{2})}{\partial u_{1}}$$

h<sup>1|2</sup>和h<sup>2|1</sup>的值在0和1之间。当它们的值与0.5不同时,我们认为这是两个资产之间预期关系的偏离。

**局限性**: 然而,这种基于收益的方法的一个重大局限性是它依赖于前一期的收益来生成进入和退出信号。这种方法可能忽略了超出近期过去收益的长期趋势和依赖性,导致次优的交易信号。

#### 2.2.2 基于水平的Copula方法

为了解决基于收益方法的局限性,Xie和Wu(2013)提出了一种新方法(以下称为基于水平的方法)。他们通过聚合公式(4)中条件概率从0.5的盈余值跨多个时期来定义新的错价指数,以确定资产失衡的程度。

**公式(5)** - 累积错价指数(CMI):
$$CMI_{t}^{1|2} = CMI_{t-1}^{1|2} + (h_{t}^{1|2} - 0.5)$$

$$CMI_{t}^{2|1} = CMI_{t-1}^{2|1} + (h_{t}^{2|1} - 0.5)$$

**局限性**: 在实践中,公式(5)中详细说明的累积错价指数(CMI)在基于水平的copula方法中的应用存在重大挑战。这些指数预期表现出均值回归行为,这是支撑这种交易策略盈利能力的关键假设。然而,CMI往往不能一致地表现出这种行为。

### 2.3 本研究的创新

为了解决这些局限性,本研究引入了一种新方法,该方法利用**平稳利差过程**而不是传统的对数收益。这种方法旨在为交易决策提供更可靠的标准,从而提高基于copula模型的稳健性和适用性。

此外,这种新方法通过在利差过程公式中引入高流动性加密货币(如比特币)作为参考资产,解决了高频数据的挑战,特别是在流动性较低的资产中。

---

## 3. 加密货币交易所和数据源

### 3.1 Binance交易所

加密货币市场促进了各种交易所的加密货币去中心化交易。Binance成立于2017年,是全球最大的加密货币交易所,在现货和衍生品市场的日交易量方面均居首位。

在这个市场中,加密货币通常以货币对的形式报价,其中一种加密货币的价值以另一种加密货币或法定货币(如美元)表示。例如,BTCUSD表示一个比特币值多少美元。

### 3.2 合约类型

Binance提供三种类型的衍生品合约:

1. **期货合约**
2. **期权**
3. **Binance杠杆代币(BLVT)**

期货合约分为两大类:
- **币本位合约**: 以美元报价但以基础加密货币(如比特币)计价的反向期货
- **USDT本位合约**: 类似于币本位期货,但以稳定币(如Tether(USDT)和Binance USD(BUSD))报价、计价和结算

本研究中,所有指定的加密货币都是USDT本位期货。我们选择USDT是因为其货币对通常比其他稳定币和许多加密货币表现出更高的流动性,使其成为在动态加密货币市场中有效实施和评估我们的交易策略的理想选择。

### 3.3 研究数据

**表1** 显示了本研究中使用的Binance USDT本位期货合约。值得注意的是,这个币种子集是根据其较早的发行和较长的市场活动历史专门选择的。

使用Binance应用程序编程接口(API),我们收集了20种加密货币从2021年1月1日至2023年1月19日的历史**每小时**和**5分钟**收盘价。

**最小订单价格**(也称为最小价格增量)是交易所中合约价格的最小可能变化。该值特定于每个资产,可以随时间调整。具有较小增量的资产具有较窄的买卖价差。

---

## 4. 理论框架

### 4.1 单位根检验

协整属性可用于从多种币的组合中识别最合适的配对。可以利用线性和非线性协整检验进行评估。

**公式(6)** - 配对利差:
$$S_{t} = P_{t}^{1} - \beta P_{t}^{2}$$

假设P<sup>1</sup><sub>t</sub>和P<sup>2</sup><sub>t</sub>是非平稳时间序列。我们使用单位根检验来确定利差S<sub>t</sub>是否也是非平稳过程。

#### 4.1.1 ADF检验

增强Dickey-Fuller(ADF)单位根检验,如Dickey和Fuller(1979)所述,使用应用于去均值利差过程S<sub>t</sub>的检验方程:

**公式(7)**:
$$\Delta S_{t} = \beta S_{t-1} + \sum_{i=1}^{p-1} \gamma_{i} \Delta S_{t-i} + \epsilon_{t}$$

其中β是序列滞后水平的系数,γ<sub>i</sub>是滞后差分的系数,ε<sub>t</sub>是误差项,p是检验中的滞后数。

**零假设**: 序列具有单位根,即β = 0

#### 4.1.2 非线性单位根检验

传统的单位根检验(如ADF检验)假设数据生成过程是线性的。然而,非线性单位根检验旨在考虑时间序列数据中的非线性,并提供更准确的单位根评估。

**SETAR模型** - 公式(8):
$$S_{t} = \sum_{i=1}^{p} \left( \phi_{i1} \mathbb{1}_{\{S_{t-d} \leq c_{1}\}} + \sum_{j=1}^{n-1} \phi_{ij} \mathbb{1}_{\{c_{j} < S_{t-d} \leq c_{j+1}\}} + \phi_{in} \mathbb{1}_{\{S_{t-d} > c_{n}\}} \right) S_{t-i} + \epsilon_{t}$$

**KSS检验**: Kapetanios等人(2003)提出了一个检验方程,其中指示函数被指数平滑转换函数替换:

**公式(9)**:
$$S_{t} = S_{t-1} + \sum_{i=1}^{p} \left( \gamma_{1i} \left( 1 - e^{-\theta(S_{t-1}-c)^{2}} \right) S_{t-i} \right) + \epsilon_{t}$$

当c设置为零且p设置为一时,使用泰勒近似,公式(9)可以表示为:

**公式(10)**:
$$\Delta S_{t} = \delta (S_{t-1})^{3} + \epsilon'_{t}$$

### 4.2 Copula概念

考虑连续随机变量X,其概率分布函数定义为F<sub>X</sub>(x) := P(X ≤ x)。

**定义**: 二维copula C是将单位正方形[0,1]²映射到单位区间[0,1]的函数,满足以下要求:

1. C(0,v) = C(u,0) = 0, 对于 0 ≤ u,v ≤ 1
2. C(u,1) = u, 和 C(1,v) = v, 对于 0 ≤ u,v ≤ 1
3. C(u₁,v₁) - C(u₁,v₂) - C(u₂,v₁) + C(u₂,v₂) ≥ 0

**Sklar定理**: 存在一个copula函数C可以连接均匀随机变量U和V到联合分布函数F<sub>X,Y</sub>:

**公式(13)**:
$$F_{X,Y}(X,Y) = F_{X,Y}(F_{X}^{-1}(U), F_{Y}^{-1}(V)) := C(U,V)$$

**公式(14)**:
$$F_{X,Y}(x,y) = C(u,v) = C(F_{X}(x), F_{Y}(y))$$

### 4.3 Copula族

本研究关注三个流行的copula族:

1. **椭圆copula** (高斯copula和学生t copula)
2. **阿基米德copula** (Clayton、Frank、Gumbel、Joe、BB1、BB6、BB7、BB8)
3. **极值copula** (Gumbel、Tawn Type 1、Tawn Type 2)

### 4.4 Copula估计

#### 4.4.1 最大似然估计(MLE)

对于(X₁,X₂),其中X<sub>i</sub> = (x<sub>i1</sub>,...,x<sub>in</sub>),对数似然函数可以表示为:

**公式(25)**:
$$l(\theta) = \sum_{j=1}^{n} \left[ \log c(F_{1}(x_{1j}; \beta_{1}), F_{2}(x_{2j}; \beta_{2}); \alpha) + \log f_{1}(x_{1j}; \beta_{1}) + \log f_{2}(x_{2j}; \beta_{2}) \right]$$

#### 4.4.2 边际推断方法(IFM)

这是一种计算上更容易的两步方法:

**步骤1** - 估计边际参数:
$$\hat{\beta}_{i} = \arg\max_{\beta_{i}} \sum_{j=1}^{n} \log f_{i}(x_{ij}; \beta_{i})$$

**步骤2** - 估计copula参数:
$$\hat{\alpha}_{ML} = \arg\max_{\alpha} \sum_{j=1}^{n} \log c(F_{1}(x_{1j}; \hat{\beta}_{1}), F_{2}(x_{2j}; \hat{\beta}_{2}); \alpha)$$

#### 4.4.3 规范最大似然(CML)

这是一种半参数方法,无需指定边际分布:

**公式(30)**:
$$\hat{\alpha}_{ML} = \arg\max_{\alpha} \sum_{j=1}^{n} \log c(\hat{F}_{n}^{1}(x_{1j}), \hat{F}_{n}^{2}(x_{2j}); \alpha)$$

---

## 5. 实施方法

### 5.1 基于参考资产的Copula方法

所提出的方法偏离传统方法,通过纳入**平稳利差过程**而不是对数收益。对于每个资产i,利差过程S<sup>i</sup><sub>t</sub>定义为:

**公式(31)**:
$$S_{t}^{i} = P_{t}^{Reference} - \hat{\beta}^{i} P_{t}^{i}$$

其中P<sup>Reference</sup><sub>t</sub>表示时间t指定参考资产的价格,而β̂<sup>i</sup>是参考资产和资产i之间的估计线性回归系数。

在本研究采用的配对交易策略框架中,利差过程定义为BTCUSDT(作为参考币)和其他加密货币的线性组合。

**公式(32)**:
$$S_{t}^{i} = BTCUSDT_{t} - \hat{\beta}^{i} P_{t}^{i}, \quad i = 1,2,...,19$$

### 5.2 为什么选择比特币作为参考资产?

比特币被选为参考资产的原因:

1. **市场影响力**: 对整个加密货币市场有重大影响,通常占加密货币总市值的很大一部分
2. **价格领导力**: 价格变动在塑造加密货币市场的趋势和情绪方面起着重要作用
3. **相对稳定性**: 与较新或不太成熟的加密货币相比,比特币通常被认为相对更稳定
4. **高流动性**: 确保利差过程保持连续性

### 5.3 配对选择流程

这使我们能够识别19个配对,并在形成期选择最优配对,以便在随后的交易期进行交易。

**选择标准**:
1. 使用线性Engle-Granger(EG)两步法和非线性Kapetanios-Shin-Snell(KSS)协整检验来识别协整币
2. 计算Kendall's Tau(τ)作为相关性度量

**公式(33)** - Kendall's Tau:
$$\tau(S^{i}, S^{j}) = \tau_{ij} = \frac{\text{一致对数} - \text{不一致对数}}{\text{总对数}}$$

计算BTCUSDT与每个19个山寨币的τ后,我们选择与BTCUSDT具有最高τ的两个山寨币,并创建它们相应的配对。

### 5.4 交易规则

在交易期间,使用随机变量U₁和U₂(转换后的利差过程值)的每小时实现,我们计算公式(4)中定义的所选周配对的copula条件概率h<sup>1|2</sup>和h<sup>2|1</sup>。

**表3** - 交易规则(以S¹和S²表示):

| 交易规则 | 信号 |
|---------|------|
| 如果 h<sup>1\|2</sup> < α₁ 且 h<sup>2\|1</sup> > 1 - α₁ | 做多S¹,做空S² |
| 如果 h<sup>1\|2</sup> > 1 - α₁ 且 h<sup>2\|1</sup> < α₁ | 做空S¹,做多S² |
| 如果 \|h<sup>1\|2</sup> - 0.5\| < α₂ 且 \|h<sup>2\|1</sup> - 0.5\| < α₂ | 平仓两个头寸 |

**表4** - 交易规则(以P¹和P²表示):

| 交易规则 | 信号 |
|---------|------|
| 如果 h<sup>1\|2</sup> < α₁ 且 h<sup>2\|1</sup> > 1 - α₁ | 做多 β² × P²,做空 β¹ × P¹ |
| 如果 h<sup>1\|2</sup> > 1 - α₁ 且 h<sup>2\|1</sup> < α₁ | 做空 β² × P²,做多 β¹ × P¹ |
| 如果 \|h<sup>1\|2</sup> - 0.5\| < α₂ 且 \|h<sup>2\|1</sup> - 0.5\| < α₂ | 平仓两个头寸 |

其中α₁和α₂表示交易阈值。我们通过回测研究最优触发。

---

## 6. 关键假设和局限性

策略的有效执行依赖于某些假设并承认特定的局限性:

### 6.1 时间框架设置

- **周期结构**: 配对交易周期在一个月内进行,三周分配给形成步骤,剩余一周指定用于交易步骤
- **滚动周期**: 进行104个动态移动的周期,每个周期与其前一个或后续周期共享四分之三的数据

### 6.2 统计检验参数

- **ADF检验**: 显著性水平为10%
- **KSS检验**: 10%显著性水平下的渐近临界值为-1.92

### 6.3 阈值设置

**所提出策略** (基于参考资产的方法):
- 进入阈值(α₁): 10%、15%和20%
- 退出阈值(α₂): 固定为10%

**基准方法**:
- **协整方法**: 进入阈值(t<sub>o</sub>) = ±2, 退出阈值(t<sub>c</sub>) = ±1, 回望窗口(N) = 1天(24小时)
- **基于收益的copula**: α₁ = 10%, α₂ = 10%
- **基于水平的copula**: t<sub>o</sub> = ±1, t<sub>c</sub> = 0

### 6.4 数据频率优势

使用5分钟级别数据时,传统的基于收益和基于水平的copula方法经常遇到问题,特别是如果分析的配对包括流动性低的加密货币。在这种情况下,流动性较低资产的5分钟对数收益可能经常等于零,这违反了copula模型基础的连续随机变量假设。

相比之下,我们新的基于参考资产的方法不依赖对数收益,而是使用BTCUSDT(一种高流动性加密货币)作为参考资产。这种方法确保公式(32)中定义的利差过程保持连续性。

### 6.5 交易执行

- **初始资本**: 20,000 USDT
- **订单类型**: 所有交易使用市价单执行,产生较高费用(taker费用)
- **手续费**: Binance USDT本位期货的maker费用为0.02%,taker费用为0.04%
- **资金管理**: 币的权重设置为确保每一边的最大初始资本约为20,000 USDT

### 6.6 市场影响考虑

根据Bağcı等人(2004)的建议,为了最小化由于价格影响而导致的潜在交易损失,资本规模理想上应小于日市场量的1%。我们的分析确定,将初始资本规模设定为20,000 USDT符合建议的阈值。

---

## 7. 实证结果

### 7.1 Copula选择频率

**表5** 显示了104个交易周内选定copula及其旋转的出现率。结果表明:

- **极值copula**(如Tawn type 1和2)发挥重要作用
- **两参数阿基米德copula**(特别是BB7和BB8)在选择适当模型的过程中起重要作用

| Copula及其旋转 | 每小时数据(EG测试) | 每小时数据(KSS测试) | 5分钟数据(EG测试) | 5分钟数据(KSS测试) |
|---------------|------------------|-------------------|-----------------|------------------|
| Gaussian | 4.0% | 6.7% | 4.0% | 7.7% |
| Student-t | 6.1% | 3.8% | 5.9% | 5.8% |
| Clayton | 6.1% | 8.7% | 4.0% | 1.9% |
| Frank | 5.1% | 3.8% | 3.0% | 1.9% |
| Gumbel | 0.0% | 5.8% | 0.0% | 2.9% |
| Joe | 8.1% | 5.8% | 8.9% | 6.7% |
| BB1 | 6.1% | 3.8% | 4.0% | 2.9% |
| BB6 | 1.0% | 1.9% | 3.0% | 2.9% |
| BB7 | 16.2% | 13.5% | 10.9% | 14.4% |
| BB8 | 10.1% | 8.7% | 15.8% | 13.5% |
| Tawn type 1 | 23.2% | 24.0% | 20.8% | 25.0% |
| Tawn type 2 | 14.1% | 13.5% | 19.8% | 14.4% |

### 7.2 策略性能

#### 7.2.1 所提出策略的性能(EG测试)

**使用5分钟数据的关键发现**:

| 指标 | α₁=10% | α₁=15% | α₁=20% |
|------|---------|---------|---------|
| **总净收益** | 144.8% | 169.8% | **205.9%** |
| **年化净收益** | 56.7% | 64.5% | **75.2%** |
| **年化标准差** | 21.3% | 25.2% | 19.9% |
| **夏普比率** | 2.66 | 2.56 | **3.77** |
| **最大回撤** | -37.1% | -39.2% | -30.5% |
| **收益/最大回撤** | 3.90 | 4.33 | **6.76** |
| **交易次数** | 188 | 242 | 266 |

**使用每小时数据**:

| 指标 | α₁=10% | α₁=15% | α₁=20% |
|------|---------|---------|---------|
| **总净收益** | 129.2% | 95.8% | 82.3% |
| **年化净收益** | 51.6% | 40.0% | 35.1% |
| **年化标准差** | 35.5% | 37.7% | 41.4% |
| **夏普比率** | 1.45 | 1.06 | 0.85 |
| **最大回撤** | -36.6% | -39.6% | -41.6% |
| **收益/最大回撤** | 3.53 | 2.42 | 1.98 |
| **交易次数** | 176 | 204 | 228 |

**关键观察**:

1. **5分钟数据显著优于每小时数据**: 最佳总净收益在α₁=0.20时达到205.9%
2. **进入阈值的影响**:
   - 5分钟数据: 年化净收益随进入阈值增加而增加(从56.7%到75.2%)
   - 每小时数据: 年化收益随进入阈值增加而减少(从51.6%到35.1%)
3. **交易成本**: 随着α₁增加而增加,但5分钟策略仍保持强劲回报

#### 7.2.2 EG vs KSS测试比较

EG和KSS测试的比较显示出不同的性能特征:

**EG测试**:
- 在每小时和5分钟数据集中表现出更高的整体净收益
- 更有利的风险调整收益(更高的夏普比率和RoMaD值)
- 5分钟数据达到令人印象深刻的年化净收益高达75.2%,夏普比率为3.77

**KSS测试**:
- 结果显著较差
- 5分钟数据遭受异常高的最大回撤(超过-160%)
- RoMaD值显著较低
- 净收益和夏普比率始终低于EG测试

### 7.3 与传统方法的比较

#### 7.3.1 协整方法

**每小时数据**: 总毛收益适中(EG为33.8%,KSS为19.3%),但受交易成本严重影响,导致所有测试中净收益为负。

**5分钟数据**: 显示更明显的效果,产生更高的毛收益,但也面临天文数字的交易成本,导致大幅负净收益。

#### 7.3.2 基于收益的Copula方法

与协整方法相比提供更高的毛收益,特别是在5分钟数据中收益达到249.6%(EG测试)。然而,这种方法也遭受极端交易成本,大大侵蚀利润,导致显著净损失(-40.1%至-1138.9%)。

#### 7.3.3 基于水平的Copula方法

呈现比其他传统策略更保守和稳定的结果:
- 在所有测试场景中产生正净收益
- 交易成本和最大回撤较低
- 年化净收益高达9.3%
- 夏普比率接近或高于0.95

**然而**: 我们提出的α₁=0.20的配对交易方法仍然表现出优于基于水平方法的风险调整性能。此外,我们提出的策略涉及的交易频率明显高于基于水平的方法。

#### 7.3.4 买入并持有策略

**比特币买入并持有**:
- 总净收益: -31.2%
- 年化夏普比率: -0.22
- 最大回撤: -77.4%

**投资组合买入并持有** (20种币等权重):
- 总净收益: 28.3%
- 年化夏普比率: 0.13
- 最大回撤: -82.7%

**对比**: 所提出的配对交易策略在性能上超过投资组合买入并持有策略高达**29倍**。

---

## 8. 结论

本研究为20种Binance USDT本位期货币开发了一种新的配对交易框架,结合了基于copula和基于协整的方法。该方法的关键特点包括:

### 8.1 方法创新

1. **参考资产方法**: 将BTCUSDT设置为参考资产,识别与其协整的其他加密货币
2. **双重协整测试**: 采用EG两步法和KSS协整测试检测协整
3. **相关性排名**: 基于Kendall's Tau相关系数对协整币进行排名
4. **动态选择**: 每周更新,在一周期间进行交易的前两个相关资产
5. **Copula条件概率**: 基于所选资产对应利差过程的copula条件概率的交易规则

### 8.2 主要发现

1. **性能优越**: 我们的策略在关键性能指标(如夏普比率和净收益)方面显著优于传统配对交易方法
   - 协整方法
   - 基于收益的copula方法
   - 基于水平的copula方法
   - 各种买入并持有策略

2. **风险调整收益**: 在风险调整收益和效率方面表现出显著改进,特别是在高频交易环境中(如5分钟数据采样)

3. **短期价格差异捕获**: 这种性能突显了我们的方法在捕获短期价格差异方面比传统方法更有效

4. **阈值选择的重要性**: 研究结果强调了选择适当进入阈值和交易频率的重要性,因为这些因素严重影响交易策略的盈利能力和波动性

### 8.3 学术和实践贡献

**学术贡献**:
- 通过提供精炼的方法论途径为学术文献做出贡献
- 有效整合不同概念并使其适应加密货币的独特特征

**实践见解**:
- 为加密货币交易领域的从业者提供有益的实践见解
- 所提出的策略有望增强盈利能力
- 作为寻求利用快速发展市场中的低效率的交易者和投资者的宝贵工具

### 8.4 最终评价

通过有效整合不同概念并使其适应加密货币的独特特征,我们提出的策略有望增强盈利能力,作为寻求利用快速发展市场中的低效率的交易者和投资者的宝贵工具。

---

## 附录

### A. 椭圆Copula

椭圆copula由多元椭圆分布构造。任何椭圆分布的密度函数f<sub>X</sub>的形式为:

**公式(17)**:
$$f_{X}(x; \mu, \Sigma) = k_{n} |\Sigma|^{-\frac{1}{2}} g((x-\mu)^{T} \Sigma^{-1} (x-\mu))$$

其中k<sub>n</sub> ∈ ℝ是归一化常数,取决于维度n,x是n维随机向量,均值向量μ ∈ ℝ<sup>n</sup>,对称正定矩阵Σ ∈ ℝ<sup>n×n</sup>,以及某个函数g(.)独立于维度n。

### B. 阿基米德Copula

根据Nelsen(2007),阿基米德copula定义为:

**公式(18)**:
$$C(u_{1},...,u_{n}) = \phi^{[-1]}(\phi(u_{1}) + \cdots + \phi(u_{n}))$$

其中φ : [0,1] → [0,∞]是连续生成器,严格递减且凸函数,使得φ(1) = 0。

**表10** 列出了本研究中使用的双变量阿基米德copula。

### C. 极值Copula

极值copula用于建模具有强尾部依赖性的依赖关系,使其适合于建模极端事件。双变量极值copula可以用Pickands依赖函数A(t)的形式表示:

**公式(23)**:
$$C(u_{1}, u_{2}) = (u_{1}u_{2})^{A(\ln(u_{2})/\ln(u_{1}u_{2}))}, \quad (u_{1}, u_{2}) \in (0,1]^{2} \setminus \{(1,1)\}$$

其中函数A : [0,1] → [1/2,1],称为Pickands依赖函数,是凸的并且对所有t ∈ [0,1]满足max(1-t, t) ≤ A(t) ≤ 1。

---

## 缩写词表

| 缩写 | 全称 |
|------|------|
| ADF | 增强Dickey-Fuller检验 |
| AIC | 赤池信息准则 |
| API | 应用程序编程接口 |
| BLVT | Binance杠杆代币 |
| BUSD | Binance美元 |
| CMI | 累积错价指数 |
| CML | 规范最大似然 |
| EG | Engle-Granger |
| IFM | 边际推断方法 |
| MLE | 最大似然估计 |
| RoMaD | 收益/最大回撤比 |
| SETAR | 自激阈值自回归 |
| SSD | 平方距离和 |
| STAR | 平滑转换自回归 |
| TAR | 阈值自回归 |
| USDT | Tether |

---

## 参考文献

[由于篇幅限制,此处省略完整参考文献列表。原文包含32页完整的学术引用]

---

**文档信息**:
- 原文DOI: 10.1186/s40854-024-00702-7
- 发表日期: 2025年1月13日
- 开放获取: 本文根据知识共享署名4.0国际许可证授权

**翻译说明**: 本文档由原英文论文翻译而成,保留了所有数学公式、表格和关键技术术语。部分专业术语在翻译时保留了英文原文以确保准确性。
